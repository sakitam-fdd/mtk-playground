var t=Object.defineProperty,e=(e,a,r)=>((e,a,r)=>a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r)(e,"symbol"!=typeof a?a+"":a,r);import{d as a,r,b as n,z as o,e as s,f as i}from"./vue-CtmyoV7S.js";import{M as l,T as c,l as d,b as p,m as u}from"./maptalks.es-DBJKwkJk.js";import{_ as h}from"./index-DOKcVjDC.js";import"./common-DJbht5QT.js";import"./element-BF3D_0r8.js";const m={id:"map",ref:"mapRef",class:"content"};const f=h(a({__name:"App",setup(t,{expose:a}){a();const s=r();function i(){const t=new l(s.value,{center:[-.113049,51.498568],zoom:14,baseLayer:new c("base",{urlTemplate:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",subdomains:["a","b","c","d"],attribution:"&copy; <a href='http://osm.org'>OpenStreetMap</a> contributors, &copy; <a href='https://carto.com/'>CARTO</a>"})});class a extends u{constructor(t,a,r){super(t,r),e(this,"data"),this.data=a}setData(t){return this.data=t,this}getData(){return this.data}}a.mergeOptions({animation:!0,color:["Red","Blue","Green","Yellow"],font:"30px san-serif"});class r extends d.CanvasRenderer{checkResources(){return[]}draw(){const t=this.layer.options.color,e=Date.now(),a=t[Math.round(e/300%t.length)],r=this._drawData(this.layer.getData(),a);this._drawnData=r,this.completeRender()}drawOnInteracting(t){if(!this._drawnData||0===this._drawnData.length)return;const e=this.layer.options.color,a=Date.now(),r=e[Math.round(a/300%e.length)];this._drawData(this._drawnData,r)}onSkipDrawOnInteracting(){}needToRedraw(){return!!this.layer.options.animation||super.needToRedraw()}_drawData(t,e){if(!Array.isArray(t))return;const a=this.getMap();this.prepareCanvas();const r=this.context;r.fillStyle=e,r.font=this.layer.options.font;const n=a.getContainerExtent(),o=[];return t.forEach((t=>{const e=a.coordinateToContainerPoint(new p(t.coord));if(!n.contains(e))return;const s=t.text,i=r.measureText(s);r.fillText(s,e.x-i.width/2,e.y),o.push(t)})),o}}a.registerRenderer("canvas",r);const n=new a("hello");return n.setData([{coord:t.getCenter().toArray(),text:"Hello World"},{coord:t.getCenter().add(.01,.01).toArray(),text:"Hello World 2"}]),n.addTo(t),()=>{t.remove()}}n((()=>{const t=i();o((()=>{t()}))}));const h={mapRef:s,initMap:i};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),[["render",function(t,e,a,r,n,o){return s(),i("div",m,null,512)}],["__file","/home/runner/work/mtk-playground/mtk-playground/.playgrounds/basic/hellolayer/animation/src/App.vue"]]);export{f as default};
